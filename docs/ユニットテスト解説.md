# ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆè§£èª¬

ã“ã®ã‚¢ãƒ—ãƒªã®ViewModelã¨Modelã®ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã«ã¤ã„ã¦è§£èª¬ã—ã¾ã™ã€‚

## ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«

| ãƒ•ã‚¡ã‚¤ãƒ« | ãƒ†ã‚¹ãƒˆå¯¾è±¡ | ãƒ†ã‚¹ãƒˆæ•° |
|---------|----------|---------|
| [ProductServiceTests.swift](../sampleShopTests/ProductServiceTests.swift) | ProductService (ViewModel) | 6å€‹ |
| [CartTests.swift](../sampleShopTests/CartTests.swift) | Cart (Model) | 15å€‹ |

## ä½¿ç”¨ã—ã¦ã„ã‚‹ãƒ†ã‚¹ãƒˆãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯

### Swift Testingï¼ˆiOS 18+ï¼‰

ã“ã®ã‚¢ãƒ—ãƒªã§ã¯ã€Appleã®æ–°ã—ã„**Swift Testing**ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ä½¿ç”¨ã—ã¦ã„ã¾ã™ã€‚

```swift
import Testing
@testable import sampleShop

struct ProductServiceTests {
    @Test("ãƒ†ã‚¹ãƒˆã®èª¬æ˜")
    func testExample() async throws {
        // Arrangeï¼ˆæº–å‚™ï¼‰
        let service = ProductService()

        // Actï¼ˆå®Ÿè¡Œï¼‰
        await service.fetchProducts()

        // Assertï¼ˆæ¤œè¨¼ï¼‰
        #expect(service.products.isEmpty == false)
    }
}
```

**å¾“æ¥ã®XCTest**:
```swift
import XCTest
@testable import sampleShop

class ProductServiceTests: XCTestCase {
    func testExample() async throws {
        XCTAssertFalse(service.products.isEmpty)
    }
}
```

**Swift Testingã®ç‰¹å¾´**:
- `@Test`å±æ€§ã§ç°¡æ½”ã«æ›¸ã‘ã‚‹
- `#expect`ã§ç›´æ„Ÿçš„ãªã‚¢ã‚µãƒ¼ã‚·ãƒ§ãƒ³
- ãƒ†ã‚¹ãƒˆã®èª¬æ˜ã‚’æ–‡å­—åˆ—ã§æ›¸ã‘ã‚‹
- async/awaitãƒã‚¤ãƒ†ã‚£ãƒ–ã‚µãƒãƒ¼ãƒˆ

## ProductServiceã®ãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆã®æ§‹æˆ

```swift
@MainActor
struct ProductServiceTests {
    // åˆæœŸçŠ¶æ…‹ã®ãƒ†ã‚¹ãƒˆ
    @Test("åˆæœŸçŠ¶æ…‹ã§ã¯å•†å“ãƒªã‚¹ãƒˆãŒç©ºã§ã‚ã‚‹")
    func testInitialState() async throws { }

    // APIå–å¾—ã®ãƒ†ã‚¹ãƒˆ
    @Test("å•†å“å–å¾—ãŒæˆåŠŸã™ã‚‹")
    func testFetchProductsSuccess() async throws { }

    @Test("ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ãŒæ­£ã—ãç®¡ç†ã•ã‚Œã‚‹")
    func testLoadingState() async throws { }

    // ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®ãƒ†ã‚¹ãƒˆ
    @Test("å–å¾—ã—ãŸå•†å“ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ã„æ§‹é€ ã‚’æŒã¤")
    func testProductDataStructure() async throws { }

    @Test("è¤‡æ•°ã®å•†å“ãŒå–å¾—ã§ãã‚‹")
    func testMultipleProducts() async throws { }

    // è¤‡æ•°å›å‘¼ã³å‡ºã—ã®ãƒ†ã‚¹ãƒˆ
    @Test("fetchProductsã‚’è¤‡æ•°å›å‘¼ã³å‡ºã—ã¦ã‚‚æ­£å¸¸ã«å‹•ä½œã™ã‚‹")
    func testMultipleFetchCalls() async throws { }
}
```

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è©³ç´°

#### 1. åˆæœŸçŠ¶æ…‹ã®ãƒ†ã‚¹ãƒˆ

```swift
@Test("åˆæœŸçŠ¶æ…‹ã§ã¯å•†å“ãƒªã‚¹ãƒˆãŒç©ºã§ã‚ã‚‹")
func testInitialState() async throws {
    // Arrange & Act
    let service = ProductService()

    // Assert
    #expect(service.products.isEmpty)
    #expect(service.isLoading == false)
    #expect(service.errorMessage == nil)
}
```

**ç›®çš„**: ViewModelã®åˆæœŸçŠ¶æ…‹ãŒæ­£ã—ã„ã“ã¨ã‚’ç¢ºèª

**æ¤œè¨¼é …ç›®**:
- `products`ãŒç©º
- `isLoading`ãŒfalse
- `errorMessage`ãŒnil

#### 2. APIå–å¾—æˆåŠŸã®ãƒ†ã‚¹ãƒˆ

```swift
@Test("å•†å“å–å¾—ãŒæˆåŠŸã™ã‚‹")
func testFetchProductsSuccess() async throws {
    // Arrange
    let service = ProductService()

    // Act
    await service.fetchProducts()

    // Assert
    #expect(!service.products.isEmpty, "å•†å“ãŒå–å¾—ã§ãã¦ã„ã‚‹ã¯ãš")
    #expect(service.isLoading == false, "ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãŒçµ‚äº†ã—ã¦ã„ã‚‹ã¯ãš")
    #expect(service.errorMessage == nil, "ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ãªã„ã¯ãš")

    // æœ€åˆã®å•†å“ãŒæ­£ã—ãå–å¾—ã§ãã¦ã„ã‚‹ã‹ç¢ºèª
    if let firstProduct = service.products.first {
        #expect(firstProduct.id > 0)
        #expect(!firstProduct.title.isEmpty)
        #expect(firstProduct.price > 0)
    }
}
```

**ç›®çš„**: å®Ÿéš›ã®APIé€šä¿¡ãŒæˆåŠŸã™ã‚‹ã“ã¨ã‚’ç¢ºèª

**æ¤œè¨¼é …ç›®**:
- å•†å“ãŒå–å¾—ã§ãã‚‹
- ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ãŒæ­£ã—ãçµ‚äº†
- ã‚¨ãƒ©ãƒ¼ãŒãªã„
- å–å¾—ã—ãŸå•†å“ãƒ‡ãƒ¼ã‚¿ãŒæœ‰åŠ¹

**æ³¨æ„**: ã“ã®ãƒ†ã‚¹ãƒˆã¯**å®Ÿéš›ã®API**ã‚’å‘¼ã³å‡ºã—ã¾ã™ï¼ˆIntegration Testã«è¿‘ã„ï¼‰

#### 3. ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã®ãƒ†ã‚¹ãƒˆ

```swift
@Test("ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ãŒæ­£ã—ãç®¡ç†ã•ã‚Œã‚‹")
func testLoadingState() async throws {
    let service = ProductService()

    let loadingTask = Task {
        await service.fetchProducts()
    }

    try await Task.sleep(nanoseconds: 10_000_000)

    await loadingTask.value

    #expect(service.isLoading == false)
}
```

**ç›®çš„**: ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ãŒæ­£ã—ãç®¡ç†ã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

**æ¤œè¨¼é …ç›®**:
- APIå‘¼ã³å‡ºã—å®Œäº†å¾Œã€`isLoading`ãŒfalseã«ãªã‚‹

#### 4. ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®ãƒ†ã‚¹ãƒˆ

```swift
@Test("å–å¾—ã—ãŸå•†å“ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ã„æ§‹é€ ã‚’æŒã¤")
func testProductDataStructure() async throws {
    let service = ProductService()
    await service.fetchProducts()

    guard let product = service.products.first else {
        Issue.record("å•†å“ãŒå–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ")
        return
    }

    #expect(product.id > 0, "IDã¯æ­£ã®æ•´æ•°ã§ã‚ã‚‹ã¹ã")
    #expect(!product.title.isEmpty, "ã‚¿ã‚¤ãƒˆãƒ«ã¯ç©ºã§ãªã„ã¹ã")
    #expect(product.price >= 0, "ä¾¡æ ¼ã¯0ä»¥ä¸Šã§ã‚ã‚‹ã¹ã")
    #expect(!product.thumbnail.isEmpty, "ã‚µãƒ ãƒã‚¤ãƒ«URLã¯ç©ºã§ãªã„ã¹ã")

    let url = URL(string: product.thumbnail)
    #expect(url != nil, "ã‚µãƒ ãƒã‚¤ãƒ«ã¯æœ‰åŠ¹ãªURLã§ã‚ã‚‹ã¹ã")
}
```

**ç›®çš„**: å–å¾—ã—ãŸå•†å“ãƒ‡ãƒ¼ã‚¿ã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ãŒæœ‰åŠ¹ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèª

**æ¤œè¨¼é …ç›®**:
- IDãŒæ­£ã®æ•´æ•°
- ã‚¿ã‚¤ãƒˆãƒ«ãŒç©ºã§ãªã„
- ä¾¡æ ¼ãŒ0ä»¥ä¸Š
- ã‚µãƒ ãƒã‚¤ãƒ«URLãŒæœ‰åŠ¹

## Cartã®ãƒ†ã‚¹ãƒˆ

### ãƒ†ã‚¹ãƒˆã®æ§‹æˆ

```swift
struct CartTests {
    // ãƒ†ã‚¹ãƒˆç”¨ãƒ˜ãƒ«ãƒ‘ãƒ¼
    func createSampleProduct(id: Int = 1, title: String = "Test Product", price: Double = 100.0) -> Product { }

    // åˆæœŸçŠ¶æ…‹ã®ãƒ†ã‚¹ãƒˆ (1å€‹)
    // å•†å“è¿½åŠ ã®ãƒ†ã‚¹ãƒˆ (3å€‹)
    // å•†å“å‰Šé™¤ã®ãƒ†ã‚¹ãƒˆ (4å€‹)
    // è¿½åŠ ã¨å‰Šé™¤ã®çµ„ã¿åˆã‚ã›ãƒ†ã‚¹ãƒˆ (1å€‹)
    // UserDefaultsæ°¸ç¶šåŒ–ã®ãƒ†ã‚¹ãƒˆ (1å€‹)
    // ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ãƒ†ã‚¹ãƒˆ (2å€‹)
}
```

### ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹è©³ç´°

#### 1. å•†å“è¿½åŠ ã®ãƒ†ã‚¹ãƒˆ

```swift
@Test("å•†å“ã‚’1ã¤è¿½åŠ ã§ãã‚‹")
func testAddSingleProduct() {
    let cart = Cart()
    let product = createSampleProduct(id: 1, title: "iPhone", price: 999.0)

    cart.add(product)

    #expect(cart.items.count == 1)
    #expect(cart.items.first?.id == 1)
    #expect(cart.items.first?.title == "iPhone")
    #expect(cart.items.first?.price == 999.0)
}
```

**ç›®çš„**: åŸºæœ¬çš„ãªè¿½åŠ æ©Ÿèƒ½ãŒå‹•ä½œã™ã‚‹ã“ã¨ã‚’ç¢ºèª

**æ¤œè¨¼é …ç›®**:
- ã‚¢ã‚¤ãƒ†ãƒ ãŒ1ã¤è¿½åŠ ã•ã‚Œã‚‹
- å•†å“ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãä¿æŒã•ã‚Œã‚‹

#### 2. é‡è¤‡å•†å“ã®è¿½åŠ ãƒ†ã‚¹ãƒˆ

```swift
@Test("åŒã˜å•†å“ã‚’è¤‡æ•°å›è¿½åŠ ã§ãã‚‹")
func testAddDuplicateProducts() {
    let cart = Cart()
    let product = createSampleProduct(id: 1, title: "iPhone", price: 999.0)

    cart.add(product)
    cart.add(product)
    cart.add(product)

    #expect(cart.items.count == 3, "åŒã˜å•†å“ã‚’3å›è¿½åŠ ã—ãŸã®ã§3å€‹ã«ãªã‚‹ã¯ãš")

    let allIdsMatch = cart.items.allSatisfy { $0.id == 1 }
    #expect(allIdsMatch, "å…¨ã¦åŒã˜å•†å“IDã§ã‚ã‚‹ã¯ãš")
}
```

**ç›®çš„**: åŒã˜å•†å“ã‚’è¤‡æ•°è¿½åŠ ã§ãã‚‹ã“ã¨ã‚’ç¢ºèªï¼ˆECã‚µã‚¤ãƒˆã®ä¸€èˆ¬çš„ãªå‹•ä½œï¼‰

#### 3. å•†å“å‰Šé™¤ã®ãƒ†ã‚¹ãƒˆ

```swift
@Test("åŒã˜å•†å“ãŒè¤‡æ•°ã‚ã‚‹å ´åˆã€å…¨ã¦å‰Šé™¤ã•ã‚Œã‚‹")
func testRemoveAllDuplicates() {
    let cart = Cart()
    let product = createSampleProduct(id: 1, title: "iPhone", price: 999.0)

    cart.add(product)
    cart.add(product)
    cart.add(product)

    #expect(cart.items.count == 3)

    cart.remove(product)

    #expect(cart.items.isEmpty, "åŒã˜IDã®å•†å“ã¯å…¨ã¦å‰Šé™¤ã•ã‚Œã‚‹ã¯ãš")
}
```

**ç›®çš„**: `removeAll`ã®å‹•ä½œã‚’ç¢ºèª

**æ¤œè¨¼é …ç›®**:
- åŒã˜IDã®å•†å“ãŒå…¨ã¦å‰Šé™¤ã•ã‚Œã‚‹

#### 4. ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã®ãƒ†ã‚¹ãƒˆ

```swift
@Test("å­˜åœ¨ã—ãªã„å•†å“ã‚’å‰Šé™¤ã—ã‚ˆã†ã¨ã—ã¦ã‚‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„")
func testRemoveNonExistentProduct() {
    let cart = Cart()
    let product1 = createSampleProduct(id: 1, title: "iPhone", price: 999.0)
    let product2 = createSampleProduct(id: 2, title: "iPad", price: 599.0)

    cart.add(product1)
    cart.remove(product2) // å­˜åœ¨ã—ãªã„å•†å“ã‚’å‰Šé™¤

    #expect(cart.items.count == 1, "ä½•ã‚‚å‰Šé™¤ã•ã‚Œãªã„ã¯ãš")
    #expect(cart.items.first?.id == 1)
}

@Test("ç©ºã®ã‚«ãƒ¼ãƒˆã‹ã‚‰å‰Šé™¤ã—ã¦ã‚‚ã‚¨ãƒ©ãƒ¼ã«ãªã‚‰ãªã„")
func testRemoveFromEmptyCart() {
    let cart = Cart()
    let product = createSampleProduct(id: 1, title: "iPhone", price: 999.0)

    cart.remove(product)

    #expect(cart.items.isEmpty)
}
```

**ç›®çš„**: ç•°å¸¸ç³»ã®å‹•ä½œã‚’ç¢ºèªï¼ˆã‚¯ãƒ©ãƒƒã‚·ãƒ¥ã—ãªã„ã“ã¨ãŒé‡è¦ï¼‰

#### 5. ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ã®ãƒ†ã‚¹ãƒˆ

```swift
@Test("å•†å“ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãä¿æŒã•ã‚Œã‚‹")
func testProductDataIntegrity() {
    let cart = Cart()
    let originalProduct = createSampleProduct(
        id: 123,
        title: "Test Product with Special Characters: æ—¥æœ¬èª & Emoji ğŸ‰",
        price: 12345.67
    )

    cart.add(originalProduct)

    guard let storedProduct = cart.items.first else {
        Issue.record("å•†å“ãŒå–å¾—ã§ãã¾ã›ã‚“ã§ã—ãŸ")
        return
    }

    #expect(storedProduct.id == originalProduct.id)
    #expect(storedProduct.title == originalProduct.title)
    #expect(storedProduct.price == originalProduct.price)
    #expect(storedProduct.thumbnail == originalProduct.thumbnail)
}
```

**ç›®çš„**: ç‰¹æ®Šæ–‡å­—ï¼ˆæ—¥æœ¬èªã€çµµæ–‡å­—ï¼‰ã‚„å°æ•°ç‚¹ã‚’å«ã‚€ãƒ‡ãƒ¼ã‚¿ãŒæ­£ã—ãä¿æŒã•ã‚Œã‚‹ã“ã¨ã‚’ç¢ºèª

## ãƒ†ã‚¹ãƒˆã®å®Ÿè¡Œæ–¹æ³•

### Xcodeã§å®Ÿè¡Œ

1. **å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ**: `Cmd + U`
2. **ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹å®Ÿè¡Œ**: ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã®æ¨ªã®â—‡ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯
3. **ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹å®Ÿè¡Œ**: å€‹åˆ¥ã®ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®æ¨ªã®â—‡ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

### ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ã§å®Ÿè¡Œ

```bash
# å…¨ãƒ†ã‚¹ãƒˆå®Ÿè¡Œ
xcodebuild test -scheme sampleShop -project sampleShop.xcodeproj -destination 'platform=iOS Simulator,name=iPhone 16,OS=latest'

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆã‚¯ãƒ©ã‚¹ã®ã¿å®Ÿè¡Œ
xcodebuild test -scheme sampleShop -project sampleShop.xcodeproj -only-testing:sampleShopTests/CartTests

# ç‰¹å®šã®ãƒ†ã‚¹ãƒˆãƒ¡ã‚½ãƒƒãƒ‰ã®ã¿å®Ÿè¡Œ
xcodebuild test -scheme sampleShop -project sampleShop.xcodeproj -only-testing:sampleShopTests/CartTests/testAddSingleProduct
```

## ãƒ†ã‚¹ãƒˆã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

### 1. AAA ãƒ‘ã‚¿ãƒ¼ãƒ³

```swift
@Test
func testExample() {
    // Arrangeï¼ˆæº–å‚™ï¼‰: ãƒ†ã‚¹ãƒˆã®æº–å‚™
    let cart = Cart()
    let product = createSampleProduct()

    // Actï¼ˆå®Ÿè¡Œï¼‰: ãƒ†ã‚¹ãƒˆå¯¾è±¡ã®æ“ä½œã‚’å®Ÿè¡Œ
    cart.add(product)

    // Assertï¼ˆæ¤œè¨¼ï¼‰: çµæœã‚’æ¤œè¨¼
    #expect(cart.items.count == 1)
}
```

### 2. ãƒ†ã‚¹ãƒˆã¯ç‹¬ç«‹ã•ã›ã‚‹

```swift
// âŒ æ‚ªã„ä¾‹: ãƒ†ã‚¹ãƒˆé–“ã§çŠ¶æ…‹ã‚’å…±æœ‰
struct BadTests {
    let sharedCart = Cart()  // å…±æœ‰çŠ¶æ…‹

    @Test
    func test1() {
        sharedCart.add(product1)
        #expect(sharedCart.items.count == 1)
    }

    @Test
    func test2() {
        // test1ã®å½±éŸ¿ã‚’å—ã‘ã‚‹ï¼
        sharedCart.add(product2)
        #expect(sharedCart.items.count == 1)  // å¤±æ•—ã™ã‚‹å¯èƒ½æ€§
    }
}

// âœ… è‰¯ã„ä¾‹: å„ãƒ†ã‚¹ãƒˆã§æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆ
struct GoodTests {
    @Test
    func test1() {
        let cart = Cart()  // æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
        cart.add(product1)
        #expect(cart.items.count == 1)
    }

    @Test
    func test2() {
        let cart = Cart()  // åˆ¥ã®æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹
        cart.add(product2)
        #expect(cart.items.count == 1)
    }
}
```

### 3. ã‚ã‹ã‚Šã‚„ã™ã„ãƒ†ã‚¹ãƒˆå

```swift
// âŒ æ‚ªã„ä¾‹
@Test func test1() { }

// âœ… è‰¯ã„ä¾‹
@Test("å•†å“ã‚’1ã¤è¿½åŠ ã§ãã‚‹")
func testAddSingleProduct() { }
```

### 4. å¤±æ•—æ™‚ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

```swift
// âŒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ãªã—
#expect(cart.items.count == 3)

// âœ… ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚ã‚Š
#expect(cart.items.count == 3, "åŒã˜å•†å“ã‚’3å›è¿½åŠ ã—ãŸã®ã§3å€‹ã«ãªã‚‹ã¯ãš")
```

### 5. ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã‚’ãƒ†ã‚¹ãƒˆ

```swift
// æ­£å¸¸ç³»ã ã‘ã§ãªãç•°å¸¸ç³»ã‚‚ãƒ†ã‚¹ãƒˆ
@Test func testRemoveFromEmptyCart() { }
@Test func testRemoveNonExistentProduct() { }
@Test func testAddZeroPriceProduct() { }
```

## ãƒ†ã‚¹ãƒˆã‚«ãƒãƒ¬ãƒƒã‚¸

### ç¾åœ¨ã®ã‚«ãƒãƒ¬ãƒƒã‚¸

| ã‚¯ãƒ©ã‚¹ | ãƒ†ã‚¹ãƒˆæ•° | ã‚«ãƒãƒ¼ã—ã¦ã„ã‚‹æ©Ÿèƒ½ |
|--------|---------|------------------|
| ProductService | 6 | åˆæœŸåŒ–ã€APIå–å¾—ã€ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°çŠ¶æ…‹ã€ãƒ‡ãƒ¼ã‚¿æ§‹é€  |
| Cart | 15 | è¿½åŠ ã€å‰Šé™¤ã€é‡è¤‡ã€ã‚¨ãƒƒã‚¸ã‚±ãƒ¼ã‚¹ã€ãƒ‡ãƒ¼ã‚¿æ•´åˆæ€§ |

### ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’ç¢ºèªã™ã‚‹æ–¹æ³•

1. Xcodeã§`Product` â†’ `Scheme` â†’ `Edit Scheme...`
2. `Test` ã‚¿ãƒ–ã‚’é¸æŠ
3. `Options` â†’ `Code Coverage` ã«ãƒã‚§ãƒƒã‚¯
4. ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¾Œã€`Report Navigator`ã§ã‚«ãƒãƒ¬ãƒƒã‚¸ã‚’ç¢ºèª

## ä»Šå¾Œã®ãƒ†ã‚¹ãƒˆæ”¹å–„æ¡ˆ

### 1. ãƒ¢ãƒƒã‚¯ã®å°å…¥

ç¾åœ¨ã®ProductServiceã®ãƒ†ã‚¹ãƒˆã¯å®Ÿéš›ã®APIã‚’å‘¼ã³å‡ºã—ã¦ã„ã¾ã™ã€‚ãƒ¢ãƒƒã‚¯ã‚’ä½¿ã†ã“ã¨ã§ï¼š

```swift
// ãƒ¢ãƒƒã‚¯ãƒ—ãƒ­ãƒˆã‚³ãƒ«
protocol ProductAPIProtocol {
    func fetchProducts() async throws -> [Product]
}

// æœ¬ç‰©ã®API
class ProductAPI: ProductAPIProtocol {
    func fetchProducts() async throws -> [Product] {
        // å®Ÿéš›ã®APIå‘¼ã³å‡ºã—
    }
}

// ãƒ¢ãƒƒã‚¯APIï¼ˆãƒ†ã‚¹ãƒˆç”¨ï¼‰
class MockProductAPI: ProductAPIProtocol {
    var shouldFail = false
    var mockProducts: [Product] = []

    func fetchProducts() async throws -> [Product] {
        if shouldFail {
            throw NetworkError.failed
        }
        return mockProducts
    }
}

// ViewModelã‚’DIå¯¾å¿œã«
class ProductService: ObservableObject {
    private let api: ProductAPIProtocol

    init(api: ProductAPIProtocol = ProductAPI()) {
        self.api = api
    }
}

// ãƒ†ã‚¹ãƒˆã§ãƒ¢ãƒƒã‚¯ã‚’æ³¨å…¥
@Test
func testFetchProductsError() async throws {
    let mockAPI = MockProductAPI()
    mockAPI.shouldFail = true

    let service = ProductService(api: mockAPI)

    await service.fetchProducts()

    #expect(service.errorMessage != nil)
}
```

### 2. UIãƒ†ã‚¹ãƒˆã®è¿½åŠ 

ç¾åœ¨ã¯ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆã®ã¿ã€‚UIãƒ†ã‚¹ãƒˆã‚‚è¿½åŠ ã™ã‚‹ã¨ï¼š

```swift
// sampleShopUITests.swift
struct ContentViewUITests {
    @Test
    func testProductListDisplay() async throws {
        let app = XCUIApplication()
        app.launch()

        // å•†å“ãƒªã‚¹ãƒˆãŒè¡¨ç¤ºã•ã‚Œã‚‹ã¾ã§å¾…ã¤
        let productList = app.lists.firstMatch
        #expect(productList.waitForExistence(timeout: 5))

        // å•†å“ãŒè¡¨ç¤ºã•ã‚Œã¦ã„ã‚‹ã‹ç¢ºèª
        let firstProduct = productList.cells.firstMatch
        #expect(firstProduct.exists)
    }
}
```

### 3. ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ

```swift
@Test
func testFetchProductsPerformance() async throws {
    let service = ProductService()

    measure {
        await service.fetchProducts()
    }
}
```

## ã¾ã¨ã‚

### ä½œæˆã—ãŸãƒ†ã‚¹ãƒˆ

| ãƒ•ã‚¡ã‚¤ãƒ« | ç›®çš„ | ãƒ†ã‚¹ãƒˆæ•° |
|---------|------|---------|
| ProductServiceTests | ViewModelã®ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ†ã‚¹ãƒˆ | 6 |
| CartTests | Modelã®ãƒ“ã‚¸ãƒã‚¹ãƒ­ã‚¸ãƒƒã‚¯ã‚’ãƒ†ã‚¹ãƒˆ | 15 |

### ãƒ†ã‚¹ãƒˆã®ãƒ¡ãƒªãƒƒãƒˆ

1. âœ… **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ãŒå®‰å…¨**: ã‚³ãƒ¼ãƒ‰å¤‰æ›´å¾Œã€ãƒ†ã‚¹ãƒˆãŒé€šã‚Œã°OK
2. âœ… **ãƒã‚°ã®æ—©æœŸç™ºè¦‹**: æ–°ã—ã„ã‚³ãƒ¼ãƒ‰ãŒãƒã‚°ã‚’ä½œã£ã¦ã„ãªã„ã‹ç¢ºèª
3. âœ… **ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ**: ãƒ†ã‚¹ãƒˆã‚³ãƒ¼ãƒ‰ãŒä»•æ§˜æ›¸ã«ãªã‚‹
4. âœ… **è¨­è¨ˆã®æ”¹å–„**: ãƒ†ã‚¹ãƒˆã—ã‚„ã™ã„ã‚³ãƒ¼ãƒ‰ã¯è‰¯ã„è¨­è¨ˆ

### æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

1. ãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦å…¨ã¦é€šã‚‹ã“ã¨ã‚’ç¢ºèª
2. ã‚«ãƒãƒ¬ãƒƒã‚¸ãƒ¬ãƒãƒ¼ãƒˆã‚’è¦‹ã¦ã€ãƒ†ã‚¹ãƒˆã•ã‚Œã¦ã„ãªã„éƒ¨åˆ†ã‚’ç¢ºèª
3. æ–°æ©Ÿèƒ½ã‚’è¿½åŠ ã™ã‚‹éš›ã¯ã€ãƒ†ã‚¹ãƒˆã‚‚ä¸€ç·’ã«æ›¸ã
4. CI/CDã§ãƒ†ã‚¹ãƒˆã‚’è‡ªå‹•å®Ÿè¡Œã™ã‚‹è¨­å®šã‚’è¿½åŠ 

**ãƒ†ã‚¹ãƒˆã¯ä¿é™ºã§ã™ã€‚æ›¸ã„ã¦ãŠã‘ã°ã€å°†æ¥ã®è‡ªåˆ†ã‚’åŠ©ã‘ã¾ã™ï¼**
